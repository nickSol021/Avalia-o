<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style_carrinho.css">
    <title>Carrinho - Mix-Modas</title>
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="logo">Mix-Modas</div>
        <div class="search-bar">
            <input type="text" placeholder="O que você procura hoje?" id="searchInput">
            <button onclick="pesquisar()">🔍</button>
        </div>
        <div class="icons">
            <a href="lista_desejos.html">❤️ Lista de Desejos</a>
            <a href="tela_login.html">👤 Entrar</a>
            <a href="carrinho.html">🛒 Seu Carrinho (2)</a>
        </div>
    </header>

    <!-- NAV CATEGORIAS -->
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="masculino.html">Masculino</a></li>
            <li><a href="feminino.html">Feminino</a></li>
            <li><a href="infantil.html">Infantil</a></li>
            <li><a href="acessorios.html">Acessórios</a></li>
        </ul>
    </nav>

    <div class="carrinho-container">
        <div class="carrinho-conteudo">
            <h1 class="carrinho-titulo">Seu Carrinho</h1>

            <div class="carrinho-itens" id="carrinhoItens">
            /div>
                <!-- Item 1 -->
                <div class="carrinho-item">
                    <img src="https://via.placeholder.com/100x100" alt="Camiseta Branca" class="carrinho-item-imagem">
                    <div class="carrinho-item-info">
                        <h3 class="carrinho-item-titulo">Camiseta Branca Básica</h3>
                        <p class="carrinho-item-preco">R$ 49,90</p>
                        <div class="carrinho-quantidade">
                            <button class="diminuir">-</button>
                            <span>1</span>
                            <button class="aumentar">+</button>
                        </div>
                        <button class="remover-item">Remover</button>
                    </div>
                </div>

                <!-- Item 2 -->
                <div class="carrinho-item">
                    <img src="https://via.placeholder.com/100x100" alt="Calça Jeans" class="carrinho-item-imagem">
                    <div class="carrinho-item-info">
                        <h3 class="carrinho-item-titulo">Calça Jeans Skinny</h3>
                        <p class="carrinho-item-preco">R$ 119,90</p>
                        <div class="carrinho-quantidade">
                            <button class="diminuir">-</button>
                            <span>1</span>
                            <button class="aumentar">+</button>
                        </div>
                        <button class="remover-item">Remover</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="resumo-pedido">
    <h2 class="resumo-titulo">Resumo do Pedido</h2>
    
    <div class="resumo-linha">
        <span>Subtotal:</span>
        <span id="subtotal">R$ 0,00</span>
    </div>
    
    <div class="resumo-linha">
        <span>Frete:</span>
        <span id="frete">R$ 0,00</span>
    </div>
    
    <div class="resumo-linha">
        <span>Desconto:</span>
        <span id="desconto">-R$ 0,00</span>
    </div>
    
    <div class="resumo-total">
        <span>Total:</span>
        <span id="total">R$ 0,00</span>
    </div>
    
    <button class="btn-finalizar">Finalizar Compra</button>
    <a href="index.html" class="continuar-comprando">Continuar comprando</a>
</div>
    <!-- FOOTER -->
    <footer>
        <p>&copy; 2025 Mix-Modas - Todos os direitos reservados</p>
    </footer>

    <script>
        // Função para carregar itens do localStorage e renderizar
function carregarCarrinho() {
    const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    const container = document.getElementById('carrinhoItens');

    if (carrinho.length === 0) {
        container.innerHTML = '<p style="text-align: center; color: #666;">Seu carrinho está vazio. <a href="index.html">Continue comprando!</a></p>';
        atualizarTotal(0, 0, 0);  // Zera totais
        return;
    }

    container.innerHTML = '';  // Limpa container
    carrinho.forEach((item, index) => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'carrinho-item';
        itemDiv.innerHTML = `
            <img src="${item.imagem}" alt="${item.nome}" class="carrinho-item-imagem">
            <div class="carrinho-item-info">
                <h3 class="carrinho-item-titulo">${item.nome}</h3>
                <p class="carrinho-item-preco">R$ ${item.preco.toFixed(2).replace('.', ',')}</p>
                <div class="carrinho-quantidade">
                    <button class="diminuir" data-index="${index}">-</button>
                    <span>${item.quantidade}</span>
                    <button class="aumentar" data-index="${index}">+</button>
                </div>
                <button class="remover-item" data-index="${index}">Remover</button>
            </div>
        `;
        container.appendChild(itemDiv);
    });

    // Adiciona event listeners após renderizar
    adicionarEventListeners();
    atualizarTotal();  // Calcula inicial
}

// Função para adicionar event listeners (agora com data-index para identificar itens)
function adicionarEventListeners() {
    // Aumentar quantidade
    document.querySelectorAll('.aumentar').forEach(button => {
        button.addEventListener('click', function() {
            const index = parseInt(this.dataset.index);
            atualizarQuantidade(index, 1);
        });
    });

    // Diminuir quantidade
    document.querySelectorAll('.diminuir').forEach(button => {
        button.addEventListener('click', function() {
            const index = parseInt(this.dataset.index);
            atualizarQuantidade(index, -1);
        });
    });

    // Remover item
    document.querySelectorAll('.remover-item').forEach(button => {
        button.addEventListener('click', function() {
            const index = parseInt(this.dataset.index);
            removerItem(index);
        });
    });
}

// Função para atualizar quantidade de um item
function atualizarQuantidade(index, delta) {
    let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    if (carrinho[index]) {
        carrinho[index].quantidade += delta;
        if (carrinho[index].quantidade <= 0) {
            carrinho[index].quantidade = 1;  // Não permite 0
        }
        localStorage.setItem('carrinho', JSON.stringify(carrinho));
        carregarCarrinho();  // Re-renderiza para atualizar spans
    }
}

// Função para remover item
function removerItem(index) {
    let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    carrinho.splice(index, 1);
    localStorage.setItem('carrinho', JSON.stringify(carrinho));
    carregarCarrinho();  // Re-renderiza
}

// Função para calcular e atualizar totais
function atualizarTotal() {
    const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    let subtotal = 0;

    carrinho.forEach(item => {
        subtotal += item.preco * item.quantidade;
    });

    const frete = subtotal > 99.99 ? 0 : 10.00;  // Grátis acima de R$99,99
    const desconto = subtotal > 100 ? 20.00 : 0;  // Fixo de R$20 para > R$100
    const total = subtotal + frete - desconto;

    // Atualiza os spans no HTML
    document.getElementById('subtotal').textContent = `R$ ${subtotal.toFixed(2).replace('.', ',')}`;
    document.getElementById('frete').textContent = frete === 0 ? 'Grátis' : `R$ ${frete.toFixed(2).replace('.', ',')}`;
    document.getElementById('desconto').textContent = `-R$ ${desconto.toFixed(2).replace('.', ',')}`;
    document.getElementById('total').textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;

    console.log('Total atualizado:', { subtotal, frete, desconto, total });
}

function pesquisar() {
    const termo = document.getElementById('searchInput').value;
    if (termo.trim()) {
        alert(`Pesquisando por: ${termo}`);
    }
}

document.getElementById('searchInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        pesquisar();
    }
});

carregarCarrinho();
    </script>
</body>
</html>
